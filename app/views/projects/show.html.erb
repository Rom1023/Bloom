<div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.2),rgba(0,0,0,0.2)),
                           url('project-show.jpg')">
  <div class="banner-text">
    <h4>Project</h4>
    <h2><%= @project.name %></h2>
  </div>
</div>
<div class="container">
  <div class="description">
    <h3><%= @project.name %></h3>
    <div class="user-info">
      <div class="mr-2"><%= image_tag "logo.png", class: "avatar" %></div>
      <% @project.creator_collaborations.each do |c| %>
        <div>
          <%= link_to c.user.full_name, user_path(c.user), class: "user-info-name" %>
          <p class="user-info-detail"><%= c.user.specialization %></p>
        </div>
        <div class="ml-auto mt-1 user-info-detail"><%= c.user.email %></div>
      <% end %>
    </div>
    <hr>
    <div>
      <p><%= @project.description %></p>
      <!--<p>Completed: < @project.completed ? "yes" : "no" %></p>-->
      <% if @project.is_admin?(current_user.id) %>
        <p><%= link_to "Edit", edit_project_path(@project), class: "btn-s-blue" %></p>
      <% end %>
    </div>
  </div>
</div>
<div class="collaborator mt-3">
  <div class="container">
    <h4>Collaborators</h4>
    <div class="collaborator-list">
      <ul>
       <% @project.my_collaborations.each do |collaboration| %>
         <li>
           <%= link_to collaboration.user.full_name, user_path(collaboration.user) %>
         </li>
       <% end %>
      </ul>
      <div>
        <%= link_to 'Become a collaborator', collaboration_path(@project), class: "btn-s-blue" %>
      </div>
    </div>
  </div>
</div>
<div class="container py-5">
  <div class="display-file">
    <div class="case">
      <div class="w-50">
        <!-- Condition to be added: admin and collaborators only-->
        <h4>Link a case</h4>
          <%= simple_form_for([@project, @link]) do |f| %>
            <%= f.association :case, label: "Pick a case", collection: current_user.cases %>
            <%= f.button :submit, class: "btn btn-s-blue" %>
          <% end %>
      </div>
      <div class="mt-3">
        <h4>Asccotiated cases</h4>
        <ul class="cards-project" >
          <% @links.each do |link| %>
            <% if link.project == @project %>
              <li class="card-case">
                <div class="card-doctor-email">
                  <span><%= link.case.user.full_name.upcase %></span>
                  <p><%= link.case.user.email %></p>
                </div>
                <div class="card-main-infos">
                  <%= link_to(case_path(link.case)) do %>
                    <!-- should be link.case.title after title added to Case-->
                    <h2>Case <%= link.case.id %> : <%= link.case.title %></h2>
                    <p><%= link.case.description %></p>
                  <% end %>
                </div>
                <div class="card-bottom-infos">
                  <div class="card-gender-age">
                    <!-- add link to patient profile page-->
                    <% if  link.case.patient.gender == "female"%>
                        <p class="rounded-gender">F</p>
                    <% else %>
                        <p class="rounded-gender">M</p>
                    <% end %>
                    <span class="card-age"><%= link.case.patient.age %> <span class="card-year">year</span></span>
                   <!--  <span>Patient: <%= link.case.patient.id %></span> -->
                  </div>
                  <div>
                    <%= link_to "Read more ï¿«",case_path(link.case) %>
                  </div>
                </div>
              </li>
            <% end %>
          <% end %>
        </ul>
      </div>
    </div>
    <div class="comment">
      <h4>Comment</h4>
      <div id="comments" class="card" data-project-id="<%= @project.id %>">
        <% @project.comments.each do |comment| %>
          <%= render 'comments/comment', comment: comment %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="">
      <%= simple_form_for [@project, @comment], remote: true do |f| %>
        <%= f.input :content, label: false, placeholder: "Comment #{current_user.full_name}" %>
        <%= f.button :submit, class: "btn btn-s-blue" %>
      <% end %>
  </div>

</div>


<!-- /projects/:project_id/comments(.:format) -->
